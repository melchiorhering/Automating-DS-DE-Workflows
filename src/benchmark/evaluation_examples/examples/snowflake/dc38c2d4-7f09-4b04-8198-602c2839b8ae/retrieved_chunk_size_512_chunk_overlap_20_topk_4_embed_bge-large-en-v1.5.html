Documentation Source:
docs.snowflake.com/en/sql-reference/functions/max_by.html

Documentation Title:
MAX_BY | Snowflake Documentation

Documentation Content:
</span></pre><span>Copy</span></div><pre><span>+-------------+---------------+--------+</span><span>| EMPLOYEE_ID | DEPARTMENT_ID | SALARY |</span><span>|-------------+---------------+--------|</span><span>|        1001 |            10 |  10000 |</span><span>|        1020 |            10 |   9000 |</span><span>|        1030 |            10 |   8000 |</span><span>|         900 |            20 |  15000 |</span><span>|        2000 |            20 |   NULL |</span><span>|        2010 |            20 |  15000 |</span><span>|        2020 |            20 |   8000 |</span><span>+-------------+---------------+--------+</span></pre><p>The following example returns the ID of the employee with the highest salary:</p><div><pre><span>SELECT</span><span>MAX_BY</span><span>(</span><span>employee_id</span><span>,</span><span>salary</span><span>)</span><span>FROM</span><span>employees</span><span>;</span></pre><span>Copy</span></div><pre><span>+-----------------------------+</span><span>| MAX_BY(EMPLOYEE_ID, SALARY) |</span><span>|-----------------------------|</span><span>|                         900 |</span><span>+-----------------------------+</span></pre><p>Note the following:</p><ul><p>Because more than one row contains the maximum value for the <span>salary</span>column, the function is non-deterministic and might
return the employee ID for a different row in subsequent executions.</p><p>The function ignores the NULL value in the <span>salary</span>column when determining the rows with the maximum values.</p></ul><p>The following example returns an ARRAY containing the IDs of the employees with the three highest salaries:</p><div><pre><span>SELECT</span><span>MAX_BY</span><span>(</span><span>employee_id</span><span>,</span><span>salary</span><span>,



Documentation Source:
docs.snowflake.com/en/sql-reference/functions/max_by.html

Documentation Title:
MAX_BY | Snowflake Documentation

Documentation Content:
</span><span>salary</span><span>,</span><span>3</span><span>)</span><span>from</span><span>employees</span><span>;</span></pre><span>Copy</span></div><pre><span>+--------------------------------+</span><span>| MAX_BY(EMPLOYEE_ID, SALARY, 3) |</span><span>|--------------------------------|</span><span>| [                              |</span><span>|   900,                         |</span><span>|   2010,                        |</span><span>|   1001                         |</span><span>| ]                              |</span><span>+--------------------------------+</span></pre><p>As shown in the example, the values in the ARRAY are sorted by their corresponding values in the <span>salary</span>column. So,
MAX_BY returns the IDs of employees sorted by their salary in descending order.</p><p>If more than one of these rows contain the same value in the <span>salary</span>column, the order of the returned values for that salary
is non-deterministic.</p></section></section></article><footer><div><p>Was this page helpful?</p><button>Yes</button><button>No</button></div><div><a>Visit Snowflake</a><a>Join the conversation</a><a>Develop with Snowflake</a><a>Share your feedback</a><a>Read the latest on our blog</a><a>Get your own certification</a></div><div><a>Privacy Notice</a><a>Site Terms</a><span>© 2024Snowflake, Inc. All Rights Reserved.</span></div></footer></div><div><p>On this page</p><ol><a>Syntax</a><a>Arguments</a><a>Returns</a><a>Usage notes</a><a>Examples</a></ol></div></div></main></div><div><div>Language: <strong>English</strong></div><div><a>English</a><a>Français</a><a>Deutsch</a><a>日本語</a><a>한국어</a><a>Português</a></div></div></div>



Documentation Source:
docs.snowflake.com/en/user-guide/ui-snowsight-query.html

Documentation Title:
Querying data using worksheets | Snowflake Documentation

Documentation Content:
Pinned objects appear at the top of the <span>Databases</span>explorer in the <span>Pinned</span>section.
You might need to expand the section to view of all your pinned objects.</p><p>After you locate a database object, you can place the name of the object in the worksheet that you’re editing:</p><ol><p>Sign in to Snowsight.</p><p>Select <span>Projects</span>» <span>Worksheets</span>to open the list of worksheets.</p><p>Open a worksheet.</p><p>Locate the database object in the <span>Databases</span>explorer.</p><li><p>Hover over the object name and select <span>…</span>more menu » <span>Place Name in Editor</span>.</p><p>The fully qualified object name appears after your cursor location in the worksheet.</p></li></ol><p>For database tables and views, you can also add the column names to the worksheet that you’re editing:</p><ol><p>Sign in to Snowsight.</p><p>Select <span>Projects</span>» <span>Worksheets</span>to open the list of worksheets.</p><p>Open a worksheet.</p><p>Locate the database object in the <span>Databases</span>explorer.</p><li><p>Hover over the object name and select <span>…</span>more menu » <span>Add Columns in Editor</span>.</p><p>The comma-separated column names appear after your cursor location in the worksheet.</p></li></ol></section><section><h3>Format your queries<a>¶</a></h3><p>When a worksheet is open, you can select the name of the worksheet to format the queries in your worksheet, and view the keyboard shortcuts.</p><ol><p>Sign in to Snowsight.</p><p>Select <span>Projects</span>» <span>Worksheets</span>to open the list of worksheets.</p><p>Open a worksheet.</p><p>Hover over the tab for the worksheet and select .</p><p>In the drop-down list,



Documentation Source:
docs.snowflake.com/en/sql-reference/functions/max_by.html

Documentation Title:
MAX_BY | Snowflake Documentation

Documentation Content:
Generation</span><span>Data Metric</span><span>Date &amp; Time</span><span>Encryption</span><span>File</span><span>Geospatial</span><span>Hash</span><span>Metadata</span><span>Notification</span><span>Numeric</span><span>Regular Expressions</span><span>Semi-Structured and Structured Data</span><span>String &amp; Binary</span><span>System</span><span>Table</span><span>Vector</span><span>Window</span><span>Stored Procedures</span></div></li><span>Class Reference</span><span>Scripting Reference</span><span>General Reference</span><span>API Reference</span></ol><div><div><nav><a>Reference</a><a>Function and Stored Procedure Reference</a><a>Aggregate</a><span>MAX_BY</span></nav><article><dl><dt>Categories:</dt><p><span>Aggregate Functions</span>(General)</p></dl><section><h1>MAX_BY<a>¶</a></h1><p>Finds the row(s) containing the maximum value for a column and returns the value of another column in that row.</p><p>For example, if a table contains the columns <span>employee_id</span>and <span>salary</span>, <code><span>MAX_BY(employee_id,</span><span>salary)</span></code>returns the value
of the <span>employee_id</span>column for the row that has the highest value in the <span>salary</span>column.</p><p>If multiple rows contain the specified maximum value, the function is non-deterministic.</p><p>To return values for multiple rows, specify the optional <span>maximum_number_of_values_to_return</span>argument.



