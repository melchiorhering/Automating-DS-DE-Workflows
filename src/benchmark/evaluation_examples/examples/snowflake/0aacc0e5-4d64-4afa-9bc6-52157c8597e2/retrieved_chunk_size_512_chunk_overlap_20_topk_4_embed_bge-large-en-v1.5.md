Documentation Source:
docs.snowflake.com/en/developer-guide/snowpark/python/python-worksheets.md

Documentation Title:
Writing Snowpark Code in Python Worksheets | Snowflake Documentation

Documentation Content:
Example: Read Files from a Stage with Python Worksheets¶

Snowpark Python lets you read files from a stage and write the contents to a table or save them as a view in Snowflake.
In this example, the Python code reads the contents of a compressed CSV-formatted file containing employee data,
data\_0\_0\_0.csv.gzfrom the db1.public.filesnamed stage and writes the contents to a table called employees.

Note

To run this code example, you must use a role that has:

The USAGE privilege on the stage, database, and schema used in the code.

The CREATE TABLE privilege on the database schema to which you want to add the table.

Sign in to Snowsight.

Open Projects» Worksheets.

Select +» Python Worksheet.

Select a database and schema that you want to add the table to.

Select a warehouse to use to run the worksheet. If you have a default warehouse for your user, it is pre-selected.
Make sure your warehouse is running.

6. Write the Snowpark Python code as part of the mainfunction:


```
importsnowflake.snowparkassnowparkfromsnowflake.snowpark.typesimport*schema_for_file=StructType([StructField("name",StringType()),StructField("role",StringType())])fileLocation="@DB1.PUBLIC.FILES/data_0_0_0.csv.gz"outputTableName="employees"defmain(session:snowpark.Session):df_reader=session.read.schema(schema_for_file)df=df_reader.csv(fileLocation)df.write.mode("overwrite").save_as_table(outputTableName)returnoutputTableName+" table successfully written from stage"
```
Copy
Select Settingsand for the Return type, select Stringfor the type returned by the handler function.

Run the code.



Documentation Source:
docs.snowflake.com/en/release-notes/2023-03.md

Documentation Title:
March 2023 | Snowflake Documentation

Documentation Content:
Python Worksheets — *Preview*¶

With this release, we are pleased to announce the preview of Python worksheets in Snowsight. Python worksheets let you write and
run Snowpark Python in a worksheet in Snowsight.

In a Python worksheet, you can do the following:

Write a Python script to read data from a stage, transform it, and save it to a table, all without leaving Snowsight.

Use included packages from Anaconda or import packages from a stage to write code more easily.

Automate your Python code by deploying it as a stored procedure and scheduling it as a task.


For more information, refer to Writing Snowpark Code in Python Worksheets.



Documentation Source:
docs.snowflake.com/en/developer-guide/snowpark/python/python-worksheets.md

Documentation Title:
Writing Snowpark Code in Python Worksheets | Snowflake Documentation

Documentation Content:
For example, you might write code in a Python worksheet that extracts data from stages or database objects in Snowflake, transforms the
data, and stores the transformed data in Snowflake. You could then
deploy that code as a stored procedureand build a data pipeline,
all without leaving Snowflake.

About Python Worksheets¶
------------------------

Python worksheets let you use Snowpark Python in Snowsight to perform data manipulations and transformations. You can use
third-party packages listed in the Snowflake Anaconda channelor import your own Python files
from stages to use in scripts.

After running a Python worksheet, review the results and output returned by your script. The results display as a string, variant, or a
table, depending on your code. See Running Python Worksheets.

Note

Because Python worksheets run inside Snowflake rather than in your local development environment, you cannot use session.add\_importto add a file that your Python code depends on, or session.add\_packagesor session.add\_requirementsto add packages that you need
to use in your Python code. Instead, you add those files to a stage and reference them in your code.
See Staging files using Snowsight.

Python worksheets have the following limitations:

Log levels lower than WARN do not appear in the Outputfor a Python worksheet by default. To log lower level messages to the output,
use a logging library such as the loggingmodule to set the level of messages logged.

No support for breakpoints or running only portions of the Python code in a worksheet.

No support for images or webpages. Images or webpages generated by Python code cannot be displayed in Python worksheets.

Python worksheets use Python 3.11 by default, but you can choose another supported version in Packages.



Documentation Source:
docs.snowflake.com/en/developer-guide/snowpark/python/python-worksheets.md

Documentation Title:
Writing Snowpark Code in Python Worksheets | Snowflake Documentation

Documentation Content:
Example: Transform Data in a Python Worksheet¶

In this example, write Python code that aggregates the entries in the TASK\_HISTORY view in the ACCOUNT\_USAGE schema of the SNOWFLAKE
database by scheduled time and state and saves the aggregated output to a table, aggregate\_task\_history.

Note

Because this example queries account usage data, you must use a role with:

Access to query the views in the ACCOUNT\_USAGE schema. See Enabling the SNOWFLAKE Database Usage for Other Roles.

The CREATE TABLE privilege on the database schema to which you want to add the table.

Sign in to Snowsight.

Open Projects» Worksheets.

Select +» Python Worksheet.

Select a database and schema that you want to add the table to.

Select a warehouse to use to run the worksheet. If you have a default warehouse for your user, it is pre-selected. Make sure your warehouse is running.

6. Write the Snowpark Python code as part of the mainfunction:


```
importsnowflake.snowparkassnowparkfromsnowflake.snowpark.functionsimportcolfromsnowflake.snowpark.dataframe_readerimport*fromsnowflake.snowpark.functionsimport*defmain(session:snowpark.Session):inputTableName="snowflake.account_usage.task_history"outputTableName="aggregate_task_history"df=session.table(inputTableName)df.filter(col("STATE")!="SKIPPED")\
    .group_by(("SCHEDULED_TIME"),"STATE").count()\
    .write.mode("overwrite").save_as_table(outputTableName)returnoutputTableName+" table successfully written"
```
Copy
Select Settingsand for the Return type, select Stringfor the type returned by the handler function.

Run the code.


After you run your code in a Python worksheet, you can open a SQL worksheet and query the table. See Querying data using worksheets.



