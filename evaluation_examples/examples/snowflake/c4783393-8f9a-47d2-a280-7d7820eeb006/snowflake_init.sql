CREATE OR REPLACE DATABASE MALL;

CREATE OR REPLACE SCHEMA MALL.PUBLIC;

CREATE OR REPLACE FILE FORMAT customers_csv_format TYPE = csv FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' SKIP_HEADER = 1 NULL_IF=('NA');

CREATE OR REPLACE STAGE MALL.PUBLIC.stage FILE_FORMAT = customers_csv_format;

CREATE OR REPLACE TABLE MALL.PUBLIC.CUSTOMERS (
    CustomerID VARCHAR(50),
    Genre VARCHAR(50),
    Age INTEGER,
    Annual_Income INTEGER,
    Spending_Score INTEGER
);

PUT file://evaluation_examples/examples/snowflake/c4783393-8f9a-47d2-a280-7d7820eeb006/old.csv @MALL.PUBLIC.stage;

COPY INTO MALL.PUBLIC.CUSTOMERS FROM @MALL.PUBLIC.stage/old.csv;

DROP TABLE MALL.PUBLIC.CUSTOMERS;